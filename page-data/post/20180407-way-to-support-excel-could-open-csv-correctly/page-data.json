{"componentChunkName":"component---src-templates-blog-post-js","path":"/post/20180407-way-to-support-excel-could-open-csv-correctly/","result":{"data":{"site":{"siteMetadata":{"title":"lqqyt2423's blog"}},"markdownRemark":{"id":"fc52ddd5-99fb-514d-ba57-3984d00b2e22","excerpt":"…","html":"<p>当用程序导出<code class=\"language-text\">UTF-8</code> 编码的<code class=\"language-text\">CSV</code> 格式的文件时，通常用<code class=\"language-text\">Mac</code> 中的<code class=\"language-text\">Numbers</code> 打开是正常的，但是用<code class=\"language-text\">Excel</code> 打开时，中文就会变成乱码。</p>\n<p>原因如下：</p>\n<blockquote>\n<p><code class=\"language-text\">Excel</code> 本身是对应了<code class=\"language-text\">UTF-8</code> 编码的，但当<code class=\"language-text\">CSV</code> 文件是<code class=\"language-text\">UTF-8</code> 编码时，原封不动的双击打开<code class=\"language-text\">CSV</code> 文件时，<code class=\"language-text\">Excel</code> 是无法识别为<code class=\"language-text\">UTF-8</code> 的，而是按照系统默认字符<code class=\"language-text\">ANSI</code> （简体中文<code class=\"language-text\">GB2312</code>、日文<code class=\"language-text\">Shift_JIS</code>）来处理的就乱码了。所以根本原因是<code class=\"language-text\">Excel</code> 字符集识别的问题。</p>\n</blockquote>\n<p>解决办法如下：</p>\n<p>在<code class=\"language-text\">CSV</code> 文件头部添加<code class=\"language-text\">BOM(Byte order mark)</code> 即可，添加之后<code class=\"language-text\">Excel</code> 便可以识别此文件是<code class=\"language-text\">UTF-8</code> 编码了。</p>\n<blockquote>\n<p>带<code class=\"language-text\">BOM</code> 的文件会比不带<code class=\"language-text\">BOM</code> 的文件多出3个字节，这三个字节是固定的：<code class=\"language-text\">0xEF 0xBB 0xBF</code>，其<code class=\"language-text\">Unicode</code> 为<code class=\"language-text\">\\uFEFF</code>。 </p>\n</blockquote>\n<p><code class=\"language-text\">JavaScript</code> 代码：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">addBom</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">csv</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> bom <span class=\"token operator\">=</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\uFEFF'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> csvBuf <span class=\"token operator\">=</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>csv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>bom<span class=\"token punctuation\">,</span> csvBuf<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>参考：</p>\n<ul>\n<li><a href=\"https://www.zhihu.com/question/21869078/answer/350728339\">csv 文件打开乱码，有哪些方法可以解决？</a></li>\n<li><a href=\"http://rensanning.iteye.com/blog/2336005\">Excel打开CSV文件乱码的问题</a></li>\n</ul>","frontmatter":{"title":"让Excel 支持打开CSV 不乱码","date":"April 06, 2018","description":""}}},"pageContext":{"slug":"/20180407-way-to-support-excel-could-open-csv-correctly/","previous":{"fields":{"slug":"/20180326-commands-of-git-remote/","path":"/post/20180326-commands-of-git-remote/"},"frontmatter":{"title":"Git 远程仓库相关的命令"}},"next":{"fields":{"slug":"/20180503-summary-of-shell-script/","path":"/post/20180503-summary-of-shell-script/"},"frontmatter":{"title":"shell script 知识点总结"}}}}}